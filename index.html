<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RW 01 Dukuh Polodadi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Arial', sans-serif; background: #f0f6f0; margin:0; padding:0; scroll-behavior: smooth; }
    header { background: linear-gradient(90deg,#2e7d32,#66bb6a); color: white; text-align:center; height: 70vh; display:flex; flex-direction:column; justify-content:center; }
    header h1 { font-size:3rem; margin-bottom:10px; animation: fadeInDown 1s; }
    header p { font-size:1.3rem; animation: fadeInUp 1.2s; }
    .btn-cta { background:#ffffff; color:#2e7d32; font-weight:bold; padding:12px 30px; border-radius:50px; border:none; transition:0.3s; }
    .btn-cta:hover { background:#e0e0e0; color:#1b5e20; transform: scale(1.05); }
    section { padding:80px 20px; }
    .card { transition: transform 0.3s, box-shadow 0.3s; border-radius:15px; }
    .card:hover { transform: translateY(-7px); box-shadow:0 10px 25px rgba(0,0,0,0.25); }
    img { border-radius:15px; transition: transform 0.3s; }
    img:hover { transform: scale(1.05); }
    .footer { background:#1b5e20; color:white; padding:40px 20px; text-align:center; }
    .animate { opacity:0; transform: translateY(30px); transition: all 0.7s ease-in-out; }
    .animate.show { opacity:1; transform: translateY(0); }
    @keyframes fadeInDown { from {opacity:0; transform: translateY(-50px);} to {opacity:1; transform: translateY(0);} }
    @keyframes fadeInUp { from {opacity:0; transform: translateY(50px);} to {opacity:1; transform: translateY(0);} }
    @media (max-width: 768px) {
      .col-md-4, .col-md-6 {
        width: 100%;
        margin-bottom: 20px;
      }
      header h1 { font-size: 2.5rem; }
      header p { font-size: 1.2rem; }
    }
  </style>
</head>
<body>

<header class="header text-center">
  <h1>RW 01 - Dukuh Polodadi</h1>
  <p>Desa Tarubasan, Kecamatan Karanganom, Kabupaten Klaten</p>
  <a href="#form-aspirasi" class="btn btn-cta mt-3">Kirim Aspirasi</a>
</header>

<!-- Saldo Kas -->
<section class="section bg-light p-4">
  <h2>Saldo Kas</h2>
  <div class="row animate" id="list-saldo"></div>
</section>

<!-- Berita & Pengumuman -->
<section class="section p-4">
  <h2>Berita & Pengumuman</h2>
  <div class="row animate" id="list-berita"></div>
</section>

<!-- Galeri Kegiatan -->
<section class="section bg-light p-4">
  <h2>Galeri Kegiatan RW</h2>
  <div class="row animate" id="list-galeri"></div>
</section>

<!-- Bisnis Warga -->
<section class="section p-4">
  <h2>Bisnis Warga</h2>
  <div class="row animate" id="list-bisnis"></div>
</section>

<!-- Formulir Aspirasi -->
<section class="section bg-light p-4">
  <h2>Formulir Aspirasi / Keluhan</h2>
  <form id="form-aspirasi" class="mb-3">
    <input name="nama" class="form-control mb-2" placeholder="Nama" required>
    <textarea name="pesan" class="form-control mb-2" placeholder="Pesan" required></textarea>
    <input type="file" class="form-control mb-2">
    <button class="btn btn-success w-100">Kirim</button>
  </form>
  <div id="list-aspirasi" class="animate"></div>
</section>

<!-- Peta Lokasi -->
<section class="section p-4">
  <h2>Peta Lokasi RW</h2>
  <div class="ratio ratio-16x9 animate">
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3959.12345!2d110.5632!3d-7.5735!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e7a69bb311ea8ff%3A0x123456789abcdef!2sRW01+Dukuh+Polodadi!5e0!3m2!1sid!2sid!4v1697670000000!5m2!1sid!2sid"
      style="border:0;" allowfullscreen="" loading="lazy"></iframe>
  </div>
</section>

<!-- Kontak Pengurus -->
<section class="section bg-light p-4 text-center">
  <h2>Kontak Pengurus RW</h2>
  <p>Ketua RW: Budi - <a href="https://wa.me/6281234567890" target="_blank">WA</a></p>
  <p>Sekretaris: Ani - <a href="https://wa.me/6281234567891" target="_blank">WA</a></p>
  <p>Bendahara: Sari - <a href="https://wa.me/6281234567892" target="_blank">WA</a></p>
</section>

<footer class="footer p-3 text-center">
  <p>&copy; 2025 RW 01 - Dukuh Polodadi, Desa Tarubasan, Kecamatan Karanganom, Kabupaten Klaten.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<script>
// URL Google Sheets (ubah sesuai milikmu)
const beritaURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGqc1G_4X3ig5TYyiIj63CPju66ZkviN7MsolUxbx0v99GYBg2P23PYtJOdvk0rpMaD2a70lVjVqKf/pub?gid=2090908824&single=true&output=csv';
const galeriURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGqc1G_4X3ig5TYyiIj63CPju66ZkviN7MsolUxbx0v99GYBg2P23PYtJOdvk0rpMaD2a70lVjVqKf/pub?gid=1520446044&single=true&output=csv';
const bisnisURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGqc1G_4X3ig5TYyiIj63CPju66ZkviN7MsolUxbx0v99GYBg2P23PYtJOdvk0rpMaD2a70lVjVqKf/pub?gid=227320896&single=true&output=csv';
const saldoURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGqc1G_4X3ig5TYyiIj63CPju66ZkviN7MsolUxbx0v99GYBg2P23PYtJOdvk0rpMaD2a70lVjVqKf/pub?gid=0&single=true&output=csv';

// Ganti dengan URL Apps Script kamu (sudah di-deploy sebagai Web App)
const scriptURL = 'https://script.google.com/macros/s/AKfycbzGshx-OzAw4_ERjNK9NBXZtd5lVg44xFBdZ7lSneOH7JioOzxoqNa7fE_15cLAwiY5/exec';

// Fungsi umum fetch CSV
function fetchCSV(url, callback) {
  Papa.parse(url, { download: true, header: true, complete: function(results) { callback(results.data); } });
}

// Saldo Kas
fetchCSV(saldoURL, data => {
  const container = document.querySelector('#list-saldo');
  data.forEach(row => {
    const div = document.createElement('div');
    div.className = 'col-md-4 card p-3 m-2 text-center';
    div.innerHTML = `<h5>${row.Kategori}</h5><p>${row.Saldo}</p>`;
    container.appendChild(div);
  });
});

// Berita
fetchCSV(beritaURL, data => {
  const container = document.querySelector('#list-berita');
  data.forEach(row => {
    const div = document.createElement('div');
    div.className = 'col-md-6 card p-3 m-2';
    div.innerHTML = `<h5>${row.Judul}</h5><small>${row.Tanggal}</small><p>${row.Isi}</p>`;
    container.appendChild(div);
  });
});

// Galeri
fetchCSV(galeriURL, data => {
  const container = document.querySelector('#list-galeri');
  data.forEach(row => {
    const div = document.createElement('div');
    div.className = 'col-md-4 mb-3';
    div.innerHTML = `<a href="${row.URL}" data-lightbox="galeri" data-title="${row.Judul}"><img src="${row.URL}" class="img-fluid rounded"></a>`;
    container.appendChild(div);
  });
});

// Bisnis Warga
fetchCSV(bisnisURL, data => {
  const container = document.querySelector('#list-bisnis');
  data.forEach(row => {
    const div = document.createElement('div');
    div.className = 'col-md-4 card p-3 m-2';
    div.innerHTML = `<h5>${row.Nama}</h5><p>${row.Deskripsi}</p><p>Harga: ${row.Harga}</p><p>Kontak: ${row.Kontak}</p>`;
    container.appendChild(div);
  });
});

// Animasi Scroll
const animElements = document.querySelectorAll('.animate');
function showOnScroll() {
  animElements.forEach(el => {
    const rect = el.getBoundingClientRect();
    if (rect.top < window.innerHeight - 100) el.classList.add('show');
  });
}
window.addEventListener('scroll', showOnScroll);
window.addEventListener('load', showOnScroll);

// Formulir Aspirasi
const form = document.querySelector('#form-aspirasi');
form.addEventListener('submit', e => {
  e.preventDefault();
  const formData = new FormData(form);
  fetch(scriptURL, { method: 'POST', body: formData })
    .then(response => alert('✅ Aspirasi berhasil dikirim!'))
    .catch(error => alert('❌ Gagal mengirim aspirasi.'));
});
</script>

</body>
</html>
